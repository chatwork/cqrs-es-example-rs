image:
repository: '{{ .Values.writeApiServer.image.repository }}'
tag: '{{ env "WRITE_API_SERVER_IMAGE_TAG" | default .Values.writeApiServer.image.tag }}'
pullPolicy: '{{ .Values.writeApiServer.image.pullPolicy }}'

{{- if .Values.ecrCred.enabled }}
    imagePullSecrets:
    - name: ecr-cred-regcred
{{- end }}

nameOverride: ""
fullnameOverride: ""

affinity: {}

command: {}

env:
{{- with .Values.writeApiServer.env }}
    {{- toYaml . | nindent 2 }}
{{- end }}
- name: "AWS_REGION"
value: {{ requiredEnv "AWS_REGION" }}

startupProbe:
enabled: false

livenessProbe:
enabled: true
initialDelaySeconds: 30
periodSeconds: 5
timeoutSeconds: 3
successThreshold: 1
failureThreshold: 3

nodeSelector: {}

podAnnotations: {}

podLabels: {}

podSecurityContext:
fsGroup: 0

readinessProbe:
enabled: true
initialDelaySeconds: 30
periodSeconds: 5
timeoutSeconds: 3
successThreshold: 1
failureThreshold: 3

replicaCount: {{ .Values.writeApiServer.replicaCount }}

resources:
{{- toYaml .Values.writeApiServer.resources | nindent 2 }}

securityContext: {}
# capabilities:
#   drop:
#   - ALL
# readOnlyRootFilesystem: true
# runAsNonRoot: true
# runAsUser: 1000

strategy:
type: RollingUpdate
rollingUpdate:
maxSurge: 10%
maxUnavailable: 0%

terminationGracePeriodSeconds: {{ add .Values.writeApiServer.processTimeoutInSec 5 }}

rbac:
create: true

serviceAccount:
create: {{ .Values.writeApiServer.serviceAccount.create }}
{{- if .Values.writeApiServer.serviceAccount.name }}
    name: {{ .Values.writeApiServer.serviceAccount.name }}
{{- end }}

service:
type: {{ .Values.writeApiServer.service.type }}
port: {{ .Values.writeApiServer.service.port }}
nodePort: {{ .Values.writeApiServer.service.nodePort }}

podDisruptionBudget:
enabled: true
maxUnavailable: 1

autoscaling:
{{- toYaml .Values.writeApiServer.autoscaling | nindent 2 }}

metrics:
enabled: false
port: 9095
path: "/"

configmaps:
chart.conf: ""
akka.conf: ""
kamon.conf: ""

useResourceApplicationConf: false